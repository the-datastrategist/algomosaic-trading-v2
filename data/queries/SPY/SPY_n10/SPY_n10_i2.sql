SELECT
Date,
Ticker,
Week,
Month,
Quarter,
Year,
Day_of_Week,
Day_of_Year,
ROR_n10,

-- # AROR
AROR_1,
AROR_2,
AROR_3,
AROR_4,
AROR_5,
AROR_10,
AROR_15,
AROR_20,
AROR_25,
AROR_30,
AROR_40,
AROR_50,
AROR_60,
AROR_70,
AROR_80,
AROR_90,
AROR_100,
AROR_110,
AROR_120,
AROR_130,
AROR_140,
AROR_150,
AROR_160,
AROR_170,
AROR_180,
AROR_190,
AROR_200,
AROR_250,
AROR_300,


-- # AROR Diffs
DIFF_AROR_3_AROR_5,
DIFF_AROR_3_AROR_10,
DIFF_AROR_3_AROR_15,
DIFF_AROR_3_AROR_20,
DIFF_AROR_3_AROR_25,
DIFF_AROR_3_AROR_50,
(AROR_3 - AROR_60)   as DIFF_AROR_3_AROR_60,
(AROR_3 - AROR_70)   as DIFF_AROR_3_AROR_70,
(AROR_3 - AROR_80)   as DIFF_AROR_3_AROR_80,
(AROR_3 - AROR_90)   as DIFF_AROR_3_AROR_90,
(AROR_3 - AROR_100)  as DIFF_AROR_3_AROR_100,

(AROR_10 - AROR_20)   as DIFF_AROR_10_AROR_20,
(AROR_10 - AROR_30)   as DIFF_AROR_10_AROR_30,
(AROR_10 - AROR_40)   as DIFF_AROR_10_AROR_40,
(AROR_10 - AROR_50)   as DIFF_AROR_10_AROR_50,
(AROR_10 - AROR_60)   as DIFF_AROR_10_AROR_60,
(AROR_10 - AROR_70)   as DIFF_AROR_10_AROR_70,
(AROR_10 - AROR_80)   as DIFF_AROR_10_AROR_80,
(AROR_10 - AROR_90)   as DIFF_AROR_10_AROR_90,
(AROR_10 - AROR_100)  as DIFF_AROR_10_AROR_100,
(AROR_10 - AROR_110)  as DIFF_AROR_10_AROR_110,
(AROR_10 - AROR_120)  as DIFF_AROR_10_AROR_120,
(AROR_10 - AROR_130)  as DIFF_AROR_10_AROR_130,
(AROR_10 - AROR_140)  as DIFF_AROR_10_AROR_140,
(AROR_10 - AROR_150)  as DIFF_AROR_10_AROR_150,
(AROR_10 - AROR_160)  as DIFF_AROR_10_AROR_160,
(AROR_10 - AROR_170)  as DIFF_AROR_10_AROR_170,
(AROR_10 - AROR_180)  as DIFF_AROR_10_AROR_180,
(AROR_10 - AROR_190)  as DIFF_AROR_10_AROR_190,
DIFF_AROR_10_AROR_200 as DIFF_AROR_10_AROR_200,



-- (AROR_90 - AROR_110)  as DIFF_AROR_XX_AROR_110,
-- (AROR_90 - AROR_120)  as DIFF_AROR_XX_AROR_120,
-- (AROR_90 - AROR_130)  as DIFF_AROR_XX_AROR_130,
-- (AROR_90 - AROR_140)  as DIFF_AROR_XX_AROR_140,
-- (AROR_90 - AROR_150)  as DIFF_AROR_XX_AROR_150,
-- (AROR_90 - AROR_160)  as DIFF_AROR_XX_AROR_160,
-- (AROR_90 - AROR_170)  as DIFF_AROR_XX_AROR_170,
-- (AROR_90 - AROR_180)  as DIFF_AROR_XX_AROR_180,
-- (AROR_90 - AROR_190)  as DIFF_AROR_XX_AROR_190,
-- (AROR_90 - AROR_200)  as DIFF_AROR_XX_AROR_200,


-- # RSI Diffs: removed

-- # Avg True Range
ATR_3,
ATR_5,
ATR_10,
ATR_15,
ATR_25,
ATR_50,
ATR_75,
ATR_100,
ATR_150,

-- # Average True Range Ratios: performs better than DIFF_ATR
safe_divide(ATR_3, ATR_5)   as RATIO_ATR_3_ATR_5,
safe_divide(ATR_3, ATR_10)  as RATIO_ATR_3_ATR_10,
safe_divide(ATR_3, ATR_25)  as RATIO_ATR_3_ATR_25,
safe_divide(ATR_3, ATR_50)  as RATIO_ATR_3_ATR_50,
safe_divide(ATR_3, ATR_100) as RATIO_ATR_3_ATR_100,

safe_divide(ATR_5, ATR_10)  as RATIO_ATR_5_ATR_10,
safe_divide(ATR_5, ATR_25)  as RATIO_ATR_5_ATR_25,
safe_divide(ATR_5, ATR_50)  as RATIO_ATR_5_ATR_50,
safe_divide(ATR_5, ATR_100) as RATIO_ATR_5_ATR_100,

safe_divide(ATR_10, ATR_25)  as RATIO_ATR_10_ATR_25,
safe_divide(ATR_10, ATR_50)  as RATIO_ATR_10_ATR_50,
safe_divide(ATR_10, ATR_100) as RATIO_ATR_10_ATR_100,
safe_divide(ATR_10, ATR_150) as RATIO_ATR_10_ATR_150,

safe_divide(ATR_25, ATR_50)  as RATIO_ATR_25_ATR_50,
safe_divide(ATR_25, ATR_100) as RATIO_ATR_25_ATR_100,
safe_divide(ATR_25, ATR_150) as RATIO_ATR_25_ATR_150,
safe_divide(ATR_50, ATR_100) as RATIO_ATR_50_ATR_100,
safe_divide(ATR_50, ATR_150) as RATIO_ATR_50_ATR_150,



# Min/Max Close
MIN_3,
MIN_4,
MIN_5,
MIN_6,
MIN_7,
MIN_8,
MIN_9,
MIN_10,
MIN_20,
MIN_30,
MIN_40,
MIN_50,
MIN_100,
MIN_200,

MAX_3,
MAX_4,
MAX_5,
MAX_6,
MAX_7,
MAX_8,
MAX_9,
MAX_10,
MAX_20,
MAX_30,
MAX_40,
MAX_50,
MAX_100,
MAX_200

FROM `algomosaic-nyc.yahoo_features.features_SPY_{partition}`
