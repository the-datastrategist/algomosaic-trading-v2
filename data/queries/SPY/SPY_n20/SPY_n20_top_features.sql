SELECT 
 ### indexes
 Date,
 Ticker,
 Week,
 Month,
 Quarter,
 Year,
 Day_of_Week,
 Day_of_Year,
 High,
 Low,
 Open,
 #Close,
 #Volume,
 Adj_Close,
 ROR_n1,
 ROR_n3,
 ROR_n5,
 ROR_n10,
 ROR_n15,
 ROR_n20,
 ROR_n25,
 ROR_n30,
 
 
 ### added features
--  (AROR_1 - AROR_10)  as DIFF_AROR_1_AROR_10,
--  (AROR_1 - AROR_20)  as DIFF_AROR_1_AROR_20,
--  (AROR_1 - AROR_30)  as DIFF_AROR_1_AROR_30,
--  (AROR_1 - AROR_40)  as DIFF_AROR_1_AROR_40,
--  (AROR_1 - AROR_50)  as DIFF_AROR_1_AROR_50,
 
--  (AROR_3 - AROR_50)  as DIFF_AROR_3_AROR_50,
--  (AROR_5 - AROR_50)  as DIFF_AROR_5_AROR_50,
--  (AROR_10 - AROR_50) as DIFF_AROR_10_AROR_50,
 
--  (AROR_5 - AROR_175)   as DIFF_AROR_5_AROR_175,
--  (AROR_10 - AROR_175)  as DIFF_AROR_10_AROR_175, 
--  (AROR_25 - AROR_175)  as DIFF_AROR_25_AROR_175,
--  (AROR_50 - AROR_175)  as DIFF_AROR_50_AROR_175,
--  (AROR_80 - AROR_175)  as DIFF_AROR_80_AROR_175,
--  (AROR_90 - AROR_175)  as DIFF_AROR_90_AROR_175,
--  (AROR_100 - AROR_175) as DIFF_AROR_100_AROR_175,
--  (AROR_125 - AROR_175) as DIFF_AROR_125_AROR_175,
--  (AROR_150 - AROR_175) as DIFF_AROR_150_AROR_175,
 
--  SAFE_DIVIDE(MAX_5, MAX_10) as RATIO_MAX_5_MAX_10,
--  SAFE_DIVIDE(MAX_5, MAX_20) as RATIO_MAX_5_MAX_20,
--  SAFE_DIVIDE(MAX_5, MAX_30) as RATIO_MAX_5_MAX_30,
--  SAFE_DIVIDE(MAX_5, MAX_40) as RATIO_MAX_5_MAX_40,
--  SAFE_DIVIDE(MAX_5, MAX_50) as RATIO_MAX_5_MAX_50,

--  SAFE_DIVIDE(MAX_10, MAX_20) as RATIO_MAX_10_MAX_20,
--  SAFE_DIVIDE(MAX_10, MAX_30) as RATIO_MAX_10_MAX_30,
--  SAFE_DIVIDE(MAX_10, MAX_40) as RATIO_MAX_10_MAX_40,
--  SAFE_DIVIDE(MAX_10, MAX_50) as RATIO_MAX_10_MAX_50,

--  SAFE_DIVIDE(MIN_5, MAX_5)   as RATIO_MIN_5_MAX_5,
--  SAFE_DIVIDE(MIN_10, MAX_10) as RATIO_MIN_10_MAX_10,
--  SAFE_DIVIDE(MIN_20, MAX_20) as RATIO_MIN_20_MAX_20,
--  SAFE_DIVIDE(MIN_30, MAX_30) as RATIO_MIN_30_MAX_30,
--  SAFE_DIVIDE(MIN_40, MAX_40) as RATIO_MIN_40_MAX_40,
--  SAFE_DIVIDE(MIN_50, MAX_50) as RATIO_MIN_50_MAX_50,


 ### features ### 
 #AROR_175,
 EMA_20,
 MAX_50,
 ATR_50,
 #DIFF_AROR_1_AROR_10,
 EMA_Volume_15,
 ATR_3,
 DIFF_AROR_3_AROR_10,
 MAX_5,
 ATR_5,
 DIFF_AROR_5_AROR_20,
--  #DIFF_AROR_10_AROR_50,
--  RATIO_EMA_3_EMA_5,
--  #DIFF_AROR_3_AROR_50,
 ATR_15,
 DIFF_AROR_5_AROR_100,
--  SO_pct_k50,
--  RATIO_EMA_10_EMA_100,
 ATR_25,
--  SO_EMA__pct_d10,
 ATR_100,
 ATR_10,
--  SO_pct_k20,
 AROR_60,
--  SO_pct_k100,
 AROR_70,
 SO_pct_k,
 DIFF_AROR_10_AROR_25,
--  RATIO_EMA_3_EMA_15,
 AROR_90,
 AROR_80,
 EMA_Volume_200,
 EMA_Volume_10,
--  RATIO_EMA_25_EMA_100,
 EMA_25,
 AROR_5,
 DIFF_AROR_10_AROR_150,
 AROR_150,
 MAX_40,
 EMA_Volume_3,
 RATIO_High_3_Close_3,
 MAX_200,
--  RATIO_EMA_25_EMA_200,
--  RATIO_EMA_3_EMA_10,
 RATIO_High_4_Close_4,
 RATIO_Close_3_Close_15,
--  SO_pct_k15,
 RATIO_High_5_Low_5,
--  #DIFF_AROR_5_AROR_50,
--  SO_EMA__pct_d5,
 RATIO_Low_4_Close_4,
--  RSI_14,
RSI_10,
 DIFF_AROR_10_AROR_100,
 MACD_9_12,
 RATIO_Low_3_Close_3,
 AROR_15,
 RATIO_Close_3_Close_10,
 MIN_50,
 RATIO_High_3_Low_3,
 RATIO_Low_Close,
 RATIO_High_Low,
 Bollinger_pct_b_50,
 RATIO_High_1_Close_1,
--  RATIO_EMA_25_EMA_50,
ROR_LOG_EMA_25_EMA_50
 RATIO_Close_10_Close_90,
 MAX_30,
--  RATIO_EMA_Volume_5_EMA_Volume_15,
ROR_LOG_EMA_Volume_5_EMA_Volume_15
 RATIO_EMA_5_EMA_25,
 RATIO_High_1_Low_1,
 DIFF_AROR_3_AROR_25,
 RATIO_High_4_Low_4,
 RATIO_Low_2_Close_2,
 EMA_Volume_25,
 #DIFF_AROR_1_AROR_50,
 EMA_Volume_100,
--  ROR_MAX_50_MIN_50,
 RATIO_High_2_Low_2,
 EMA_3,
 MIN_10,
 DIFF_AROR_10_AROR_20,
 RATIO_High_Close,
--  Mass_Index,
--  ROR_MAX_20_MIN_20,
 EMA_5,
 DIFF_AROR_3_AROR_15,
 DIFF_AROR_10_AROR_200,
 AROR_20,
--  ROR_MAX_5_MIN_5,
 AROR_40,
 RATIO_Low_5_Close_5,
--  RATIO_EMA_50_EMA_100,
ROR_LOG_EMA_50_EMA_100
--  #DIFF_AROR_1_AROR_20,
 RATIO_Close_15_Close_30,
 RATIO_Low_1_Close_1,
 RATIO_High_5_Close_5,
 DIFF_AROR_1_AROR_5,
--  RATIO_EMA_10_EMA_200
ROR_LOG_EMA_10_EMA_200
 
 FROM `algomosaic-nyc.yahoo_features.features_SPY_{partition}`
 
 